#!/usr/bin/env bash
set -euo pipefail

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ“¦ Installing Selected Packages"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# æ˜¾ç¤ºå°†è¦å®‰è£…çš„ç±»åˆ«
echo "Categories selected:"
{{ if .install_core_cli -}}
echo "  âœ“ Core CLI Tools"
{{ end -}}
{{ if .install_fonts -}}
echo "  âœ“ Fonts"
{{ end -}}
{{ if .install_security -}}
echo "  âœ“ Security Tools"
{{ end -}}
{{ if .install_gui -}}
echo "  âœ“ GUI Applications"
{{ end -}}
{{ if .install_runtime -}}
echo "  âœ“ Development Runtimes"
{{ end -}}
{{ if .install_maintenance -}}
echo "  âœ“ Maintenance Tools"
{{ end -}}

echo ""
echo "â³ Installing via Homebrew..."

# Render Brewfile to a temporary location
BREWFILE=$(mktemp)
# Use chezmoi execute-template to render the Brewfile
# We read the template file from the source directory
chezmoi execute-template < "{{ .chezmoi.sourceDir }}/data/Brewfile.tmpl" > "$BREWFILE"

# Execute installation
brew bundle --no-lock --file="$BREWFILE"

rm "$BREWFILE"

echo ""
echo "âœ… Installation complete!"
