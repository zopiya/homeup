# ==============================================================================
# Chezmoi Configuration
# ==============================================================================
# This file defines global variables used across all dotfiles templates
# Chezmoi processes .tmpl files and replaces template variables with values below

# --- Source Directory ---
sourceDir = "{{ .chezmoi.homeDir }}/.local/share/chezmoi"

# ==============================================================================
# Global Variables
# ==============================================================================
[data]
    # --- User Identity ---
    name = "zopiya"
    email = "i@zopiya.com"

    # --- SSH FIDO2 Keys (YubiKey Hardware Tokens) ---
    # Format: File path to SSH public key (e.g., "~/.ssh/main-ssh.zopiya.com.pub")
    # Alternatively: "key::<algorithm> <public_key_data>" for agent forwarding
    #
    # Using file paths for local FIDO2 keys provides better compatibility with
    # macOS SSH agent and YubiKey resident keys. The "key::" format is useful
    # for remote signing scenarios but can cause "agent refused operation" errors
    # with hardware-backed keys that require user presence (touch).
    #
    # How to Get Your Keys:
    #   1. List SSH public keys: ssh-add -L
    #   2. Or read from file: cat ~/.ssh/main-ssh.zopiya.com.pub
    #
    # Key Format Breakdown:
    #   - sk-ssh-ed25519@openssh.com: Algorithm (FIDO2 security key)
    #   - AAAA....: Base64-encoded public key data
    #   - main-ssh.zopiya.com: Comment (identifies the key)
    #
    # Security Notes:
    #   - Public keys only (safe to commit to Git)
    #   - Private keys stay on YubiKey (never leave hardware)
    #   - Both keys uploaded to GitHub/GitLab for verification

    # Main YubiKey (primary signing key - currently active)
    # Note: Use private key path (without .pub) for signing
    signingkey = "~/.ssh/main-ssh.zopiya.com"

    # Backup YubiKey (alternate signing key - for emergencies)
    # Both keys are always trusted in ~/.ssh/allowed_signers
    # To switch: Edit this file and swap the active signingkey, then run: chezmoi apply
    backupsigningkey = "~/.ssh/back-ssh.zopiya.com"

    # --- Profile Selection ---
    # Controls which dotfiles are deployed and how tools are configured
    # Profiles:
    #   - macos: Trust anchor with local YubiKeys, full tooling, agent forwarding
    #   - linux: Zero trust remote server, no local keys, minimal tools
    #   - mini:  Borrowed environment (containers, VMs), agent forwarding from host
    #
    # Default: mini (safest for unknown environments)
    # Override: export HOMEUP_PROFILE=macos && chezmoi apply
    profile = "{{ env "HOMEUP_PROFILE" | default "mini" }}"

# --- Editor ---
[edit]
    command = "nvim"

# --- Diff ---
[diff]
    command = "delta"
    pager = "delta"
    # exclude = ["scripts/**", "externals/**"]

# --- Merge ---
[merge]
    command = "nvim"
    args = ["-d", "{{ `{{ .Destination }}` }}", "{{ `{{ .Source }}` }}", "{{ `{{ .Target }}` }}"]

# --- Update ---
[update]
    apply = false
    method = "brew"
